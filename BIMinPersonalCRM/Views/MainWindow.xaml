
<Window x:Class="BIMinPersonalCRM.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:viewModels="clr-namespace:BIMinPersonalCRM.ViewModels"
        xmlns:models="clr-namespace:BIMinPersonalCRM.Models"
        xmlns:local="clr-namespace:BIMinPersonalCRM.Converters"
        xmlns:controls="clr-namespace:BIMinPersonalCRM.Views.Controls"
        xmlns:customControls="clr-namespace:BIMinPersonalCRM.Controls"
        xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.WPF;assembly=LiveChartsCore.SkiaSharpView.WPF"
        mc:Ignorable="d"
        Title="BIMin Personal CRM"
        Height="900"
        Width="1600"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}">
    <Window.DataContext>
        <viewModels:MainViewModel />
    </Window.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <materialDesign:ColorZone Grid.Row="0" Mode="PrimaryMid" Padding="16" materialDesign:ElevationAssist.Elevation="Dp4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <materialDesign:PackIcon Kind="BusinessCard" Width="32" Height="32" Foreground="White"/>
                    <TextBlock Text="BIMin Personal CRM" FontSize="20" FontWeight="Medium" Margin="12,0,0,0" Foreground="White"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Style="{StaticResource MaterialDesignFlatButton}" Foreground="White" Command="{Binding SaveCommand}" Margin="0,0,8,0">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <materialDesign:PackIcon Kind="ContentSave" Width="16" Height="16"/>
                            <TextBlock Text="Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ" Margin="8,0,0,0"/>
                        </StackPanel>
                    </Button>
                    <Button Style="{StaticResource MaterialDesignFlatButton}" Foreground="White" Command="{Binding LoadCommand}">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <materialDesign:PackIcon Kind="FolderOpen" Width="16" Height="16"/>
                            <TextBlock Text="Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ" Margin="8,0,0,0"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </materialDesign:ColorZone>

        <TabControl Grid.Row="1" Style="{StaticResource MaterialDesignTabControl}" materialDesign:ColorZoneAssist.Mode="PrimaryMid" ItemContainerStyle="{StaticResource CustomTabItemStyle}">
            <TabItem Header="ÐšÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="360"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" Margin="16,16,8,16">
                        <materialDesign:Card Padding="16" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBox materialDesign:HintAssist.Hint="ÐŸÐ¾Ð¸ÑÐº" Text="{Binding CompanySearchText, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                                <ComboBox Margin="0,16,0,0" Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                          ItemsSource="{Binding RelationshipStatusFilter}"
                                          SelectedItem="{Binding SelectedRelationshipFilter}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Converter={x:Static local:EnumDescriptionConverter.Instance}}"/>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <ComboBox Margin="0,8,0,0" Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                          ItemsSource="{Binding PaymentAbilityFilter}"
                                          SelectedItem="{Binding SelectedPaymentAbilityFilter}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Converter={x:Static local:EnumDescriptionConverter.Instance}}"/>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <StackPanel Orientation="Horizontal" Margin="0,16,0,0">
                                    <Button Content="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ" Command="{Binding AddCompanyCommand}" Style="{StaticResource MaterialDesignRaisedButton}"/>
                                </StackPanel>
                            </StackPanel>
                        </materialDesign:Card>

                        <materialDesign:Card Margin="0" Padding="0">
                            <ListBox ItemsSource="{Binding FilteredCompanies}"
                                     SelectedItem="{Binding SelectedCompany}"
                                     Background="Transparent"
                                     BorderThickness="0"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                <ListBox.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Vertical"/>
                                    </ItemsPanelTemplate>
                                </ListBox.ItemsPanel>
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <controls:CompanyCard Margin="12"/>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </materialDesign:Card>
                    </StackPanel>

                    <ScrollViewer Grid.Column="1" Margin="0,16,16,16">
                        <StackPanel>
                            <materialDesign:Card Padding="16" Margin="0,0,0,16">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="{Binding SelectedCompany.Name, FallbackValue='Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸ÑŽ'}" FontSize="20" FontWeight="Medium"/>
                                    <Button Grid.Column="1" Content="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ" Command="{Binding DeleteCompanyCommand}"
                                            Visibility="{Binding SelectedCompany, Converter={x:Static local:NullToVisibilityConverter.Instance}, ConverterParameter=Inverse}"
                                            Style="{StaticResource MaterialDesignOutlinedButton}"/>
                                </Grid>
                            </materialDesign:Card>

                            <materialDesign:Card Padding="16" Margin="0,0,0,16">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBox Grid.Row="0" Grid.Column="0" Margin="0,0,8,8" materialDesign:HintAssist.Hint="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ" Text="{Binding SelectedCompany.Name}" Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                                    <TextBox Grid.Row="0" Grid.Column="1" Margin="8,0,0,8" materialDesign:HintAssist.Hint="Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½" Text="{Binding SelectedCompany.Phone}" Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                                    <TextBox Grid.Row="1" Grid.Column="0" Margin="0,0,8,8" materialDesign:HintAssist.Hint="Ð¡Ð°Ð¹Ñ‚" Text="{Binding SelectedCompany.Website}" Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                                    <customControls:ColorPickerControl Grid.Row="1" Grid.Column="1" Margin="8,0,0,8" SelectedColorText="{Binding SelectedCompany.CardColor}"/>
                                    <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,8,0,0">
                                        <TextBox Width="220" materialDesign:HintAssist.Hint="Ð›Ð¾Ð³Ð¾Ñ‚Ð¸Ð¿" Text="{Binding SelectedCompany.LogoPath}" IsReadOnly="True" Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                                        <Button Content="Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ" Command="{Binding SelectLogoCommand}" Style="{StaticResource MaterialDesignOutlinedButton}" Margin="8,0,0,0"/>
                                        <Button Content="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ" Command="{Binding RemoveLogoCommand}" Style="{StaticResource MaterialDesignOutlinedButton}" Margin="8,0,0,0"/>
                                    </StackPanel>
                                </Grid>
                            </materialDesign:Card>
                            <materialDesign:Card Padding="16" Margin="0,0,0,16">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                        <TextBlock Text="Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¸" FontSize="16" FontWeight="Medium"/>
                                        <Button Content="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ" Command="{Binding AddEmployeeCommand}" Style="{StaticResource MaterialDesignRaisedButton}" Margin="16,0,0,0"/>
                                        <Button Content="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ" Command="{Binding RemoveEmployeeCommand}" Style="{StaticResource MaterialDesignOutlinedButton}" Margin="8,0,0,0"/>
                                    </StackPanel>
                                    <DataGrid ItemsSource="{Binding Employees}"
                                              SelectedItem="{Binding SelectedEmployee}"
                                              AutoGenerateColumns="False"
                                              CanUserAddRows="False"
                                              Margin="0,0,0,8">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Ð˜Ð¼Ñ" Binding="{Binding FullName}" Width="200"/>
                                            <DataGridTextColumn Header="Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ" Binding="{Binding Position}" Width="200"/>
                                            <DataGridTextColumn Header="Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½" Binding="{Binding Phone}" Width="140"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </materialDesign:Card>

                            <materialDesign:Card Padding="16" Margin="0,0,0,16">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                        <TextBlock Text="Ð—Ð°ÐºÐ°Ð·Ñ‹" FontSize="16" FontWeight="Medium"/>
                                        <Button Content="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ" Command="{Binding AddOrderCommand}" Style="{StaticResource MaterialDesignRaisedButton}" Margin="16,0,0,0"/>
                                    </StackPanel>
                                    <DataGrid x:Name="OrdersDataGrid"
                                              ItemsSource="{Binding Orders}"
                                              SelectedItem="{Binding SelectedOrder}"
                                              AutoGenerateColumns="False"
                                              CanUserAddRows="False"
                                              RowEditEnding="OrdersDataGrid_RowEditEnding"
                                              Margin="0,0,0,8">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ" Binding="{Binding Name}" Width="200"/>
                                            <DataGridTextColumn Header="Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ" Binding="{Binding Price, StringFormat='{}{0:N2}'}" Width="120"/>
                                            <DataGridTextColumn Header="Ð¡Ñ‚Ð°Ñ‚ÑƒÑ" Binding="{Binding ExecutionStatus, Converter={x:Static local:EnumDescriptionConverter.Instance}}" Width="150"/>
                                            <DataGridTextColumn Header="Ð¡Ð¾Ð·Ð´Ð°Ð½" Binding="{Binding CreatedDate, StringFormat='{}{0:dd.MM.yyyy}'}" Width="120"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </materialDesign:Card>

                            <materialDesign:Card Padding="16" Margin="0,0,0,16">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12" VerticalAlignment="Center">
                                        <TextBlock Text="Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð·Ð°Ð´Ð°Ñ‡Ð°" FontSize="16" FontWeight="Medium"/>
                                        <Button Content="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ" Command="{Binding AddTaskCommand}" Style="{StaticResource MaterialDesignOutlinedButton}" Margin="16,0,0,0"/>
                                        <Button Content="Ð¡Ñ‚Ð°Ñ€Ñ‚" Command="{Binding StartTimerCommand}" Style="{StaticResource MaterialDesignRaisedButton}" Margin="16,0,0,0" Background="{DynamicResource PrimaryHueMidBrush}"/>
                                        <Button Content="Ð¡Ñ‚Ð¾Ð¿" Command="{Binding StopTimerCommand}" Style="{StaticResource MaterialDesignRaisedButton}" Margin="8,0,0,0" Background="{DynamicResource ValidationErrorBrush}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                        <TextBlock Text="{Binding TimerStatus}" FontSize="14" Margin="0,0,16,0"/>
                                        <TextBlock Text="{Binding SelectedTask.HoursSpent, StringFormat='{}{0:N2} Ñ‡'}" FontSize="18" FontWeight="SemiBold"/>
                                    </StackPanel>
                                    <DataGrid ItemsSource="{Binding Tasks}" SelectedItem="{Binding SelectedTask}" AutoGenerateColumns="False" CanUserAddRows="False" Margin="0,0,0,8">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ" Binding="{Binding Name}" Width="200"/>
                                            <DataGridTextColumn Header="Ð¡Ñ‚Ð°Ñ‚ÑƒÑ" Binding="{Binding Status, Converter={x:Static local:EnumDescriptionConverter.Instance}}" Width="120"/>
                                            <DataGridTextColumn Header="Ð¡Ñ‚Ð°Ñ€Ñ‚" Binding="{Binding StartDate, StringFormat='{}{0:dd.MM.yyyy}'}" Width="120"/>
                                            <DataGridTextColumn Header="Ð§Ð°ÑÑ‹" Binding="{Binding HoursSpent, StringFormat='{}{0:N2}'}" Width="120"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </materialDesign:Card>

                            <materialDesign:Card Padding="16">
                                <StackPanel>
                                    <TextBlock Text="ÐŸÑ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹" FontSize="16" FontWeight="Medium" Margin="0,0,0,12"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                        <Button Content="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ" Command="{Binding AddFileCommand}" Style="{StaticResource MaterialDesignRaisedButton}" Margin="0,0,8,0"/>
                                        <Button Content="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ" Command="{Binding RemoveFileCommand}" Style="{StaticResource MaterialDesignOutlinedButton}"/>
                                    </StackPanel>
                                    <DataGrid ItemsSource="{Binding AttachedFiles}" SelectedItem="{Binding SelectedFile}" AutoGenerateColumns="False" CanUserAddRows="False">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Ð˜Ð¼Ñ" Binding="{Binding Name}" Width="200"/>
                                            <DataGridTextColumn Header="Ð¢Ð¸Ð¿" Binding="{Binding FileType, Converter={x:Static local:EnumDescriptionConverter.Instance}}" Width="120"/>
                                            <DataGridTextColumn Header="ÐŸÑƒÑ‚ÑŒ" Binding="{Binding Path}" Width="*"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </materialDesign:Card>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </TabItem>

            <TabItem Header="Ð—Ð°ÐºÐ°Ð·Ñ‹ &amp; Ð·Ð°Ð´Ð°Ñ‡Ð¸">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <materialDesign:Card Grid.Row="0" Padding="16" Margin="0,0,0,16">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBox Width="220" Margin="0,0,16,0" materialDesign:HintAssist.Hint="ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð·Ð°ÐºÐ°Ð·Ð°Ð¼" Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                     Text="{Binding OrderSearchText, UpdateSourceTrigger=PropertyChanged}"/>
                            <ComboBox Width="200" Margin="0,0,16,0" Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                      ItemsSource="{Binding Companies}"
                                      SelectedItem="{Binding SelectedCompanyFilter}"
                                      DisplayMemberPath="Name"/>
                            <ComboBox Width="200" Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                      ItemsSource="{Binding OrderStatusFilter}"
                                      SelectedItem="{Binding SelectedOrderStatusFilter}">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Converter={x:Static local:EnumDescriptionConverter.Instance}}"/>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </StackPanel>
                    </materialDesign:Card>

                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"/>
                            <ColumnDefinition Width="3*"/>
                        </Grid.ColumnDefinitions>

                        <materialDesign:Card Grid.Column="0" Padding="16" Margin="0,0,16,0">
                            <StackPanel>
                                <TextBlock Text="Ð’ÑÐµ Ð·Ð°ÐºÐ°Ð·Ñ‹" FontSize="16" FontWeight="Medium" Margin="0,0,0,12"/>
                                <DataGrid ItemsSource="{Binding FilteredOrders}" SelectedItem="{Binding SelectedOrder}" AutoGenerateColumns="False" CanUserAddRows="False">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="ÐšÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ñ" Binding="{Binding Company.Name}" Width="200"/>
                                        <DataGridTextColumn Header="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ" Binding="{Binding Name}" Width="200"/>
                                        <DataGridTextColumn Header="Ð¡Ñ‚Ð°Ñ‚ÑƒÑ" Binding="{Binding ExecutionStatus, Converter={x:Static local:EnumDescriptionConverter.Instance}}" Width="150"/>
                                        <DataGridTextColumn Header="Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ" Binding="{Binding Price, StringFormat='{}{0:N2}'}" Width="120"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </materialDesign:Card>

                        <materialDesign:Card Grid.Column="1" Padding="16">
                            <StackPanel>
                                <TextBlock Text="Ð’ÑÐµ Ð·Ð°Ð´Ð°Ñ‡Ð¸" FontSize="16" FontWeight="Medium" Margin="0,0,0,12"/>
                                <DataGrid ItemsSource="{Binding AllTasks}" SelectedItem="{Binding SelectedTask}" AutoGenerateColumns="False" CanUserAddRows="False">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Ð—Ð°Ð´Ð°Ñ‡Ð°" Binding="{Binding Name}" Width="200"/>
                                        <DataGridTextColumn Header="Ð—Ð°ÐºÐ°Ð·" Binding="{Binding Order.Name}" Width="200"/>
                                        <DataGridTextColumn Header="ÐšÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ñ" Binding="{Binding Order.Company.Name}" Width="200"/>
                                        <DataGridTextColumn Header="Ð¡Ñ‚Ð°Ñ‚ÑƒÑ" Binding="{Binding Status, Converter={x:Static local:EnumDescriptionConverter.Instance}}" Width="120"/>
                                        <DataGridTextColumn Header="Ð§Ð°ÑÑ‹" Binding="{Binding HoursSpent, StringFormat='{}{0:N2}'}" Width="80"/>
                                        <DataGridTextColumn Header="Ð”Ð°Ñ‚Ð°" Binding="{Binding StartDate, StringFormat='{}{0:dd.MM.yyyy}'}" Width="100"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </materialDesign:Card>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°">
                <ScrollViewer Padding="16">
                    <StackPanel>
                        <materialDesign:Card Padding="16" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ¸" FontSize="16" FontWeight="Medium"/>
                                <WrapPanel Margin="0,16,0,0" ItemHeight="Auto">
                                    <ComboBox Width="220" Margin="0,0,16,0" Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                              ItemsSource="{Binding StatisticsPeriods}" SelectedItem="{Binding SelectedStatisticsPeriod}" DisplayMemberPath="DisplayName"/>
                                    <ComboBox Width="240" Margin="0,0,16,0" Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                              ItemsSource="{Binding StatisticsSortOptions}" SelectedItem="{Binding SelectedStatisticsSort}" DisplayMemberPath="DisplayName"/>
                                    <TextBox Width="220" Margin="0,0,16,0" Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                             materialDesign:HintAssist.Hint="ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸"
                                             Text="{Binding StatisticsSearchText, UpdateSourceTrigger=PropertyChanged}"/>
                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,8,0,0">
                                        <TextBlock Text="ÐœÐ¸Ð½. Ð·Ð°ÐºÐ°Ð·Ð¾Ð²:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                        <Slider Width="180" Minimum="0" Maximum="50" TickFrequency="1" IsSnapToTickEnabled="True"
                                                Value="{Binding StatisticsMinOrders, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <TextBlock Text="{Binding StatisticsMinOrders, StringFormat='{}{0:0}'}" VerticalAlignment="Center" FontWeight="SemiBold" Margin="8,0,0,0"/>
                                    </StackPanel>
                                </WrapPanel>
                            </StackPanel>
                        </materialDesign:Card>

                        <materialDesign:Card Padding="16" Margin="0,0,0,16">
                            <UniformGrid Columns="3" Rows="2" Margin="0,0,0,8">
                                <StackPanel Margin="8,4">
                                    <TextBlock Text="ÐšÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¹" FontSize="12" Opacity="0.7"/>
                                    <TextBlock Text="{Binding TotalCompaniesCount}" FontSize="24" FontWeight="SemiBold"/>
                                </StackPanel>
                                <StackPanel Margin="8,4">
                                    <TextBlock Text="Ð—Ð°ÐºÐ°Ð·Ð¾Ð²" FontSize="12" Opacity="0.7"/>
                                    <TextBlock Text="{Binding TotalOrdersCount}" FontSize="24" FontWeight="SemiBold"/>
                                </StackPanel>
                                <StackPanel Margin="8,4">
                                    <TextBlock Text="Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾" FontSize="12" Opacity="0.7"/>
                                    <TextBlock Text="{Binding PaidOrdersCount}" FontSize="24" FontWeight="SemiBold"/>
                                </StackPanel>
                                <StackPanel Margin="8,4">
                                    <TextBlock Text="Ð’Ñ‹Ñ€ÑƒÑ‡ÐºÐ°" FontSize="12" Opacity="0.7"/>
                                    <TextBlock Text="{Binding TotalMoneyEarned, StringFormat='{}{0:N0}'}" FontSize="24" FontWeight="SemiBold"/>
                                </StackPanel>
                                <StackPanel Margin="8,4">
                                    <TextBlock Text="Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾ Ð·Ð°Ð´Ð°Ñ‡" FontSize="12" Opacity="0.7"/>
                                    <TextBlock Text="{Binding CompletedTasksCount}" FontSize="24" FontWeight="SemiBold"/>
                                </StackPanel>
                                <StackPanel Margin="8,4">
                                    <TextBlock Text="Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡" FontSize="12" Opacity="0.7"/>
                                    <TextBlock Text="{Binding TaskCompletionPercentage, StringFormat='{}{0:N0}%'}" FontSize="24" FontWeight="SemiBold"/>
                                </StackPanel>
                            </UniformGrid>
                        </materialDesign:Card>

                        <Grid Margin="0,0,0,16">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <materialDesign:Card Grid.Row="0" Grid.ColumnSpan="2" Padding="16" Margin="0,0,0,16">
                                <StackPanel>
                                    <TextBlock Text="Ð”Ð¸Ð½Ð°Ð¼Ð¸ÐºÐ° Ð²Ñ‹Ñ€ÑƒÑ‡ÐºÐ¸ Ð¿Ð¾ Ð¼ÐµÑÑÑ†Ð°Ð¼" FontSize="16" FontWeight="Medium" Margin="0,0,0,12"/>
                                    <lvc:CartesianChart Series="{Binding RevenueTrendSeries}"
                                                        XAxes="{Binding RevenueTrendXAxis}"
                                                        YAxes="{Binding RevenueTrendYAxis}"
                                                        LegendPosition="Bottom"
                                                        Height="260"/>
                                </StackPanel>
                            </materialDesign:Card>

                            <materialDesign:Card Grid.Row="1" Grid.Column="0" Padding="16" Margin="0,0,16,0">
                                <StackPanel>
                                    <TextBlock Text="Ð¡Ñ‚Ð°Ñ‚ÑƒÑÑ‹ Ð·Ð°ÐºÐ°Ð·Ð¾Ð²" FontSize="16" FontWeight="Medium" Margin="0,0,0,12"/>
                                    <lvc:CartesianChart Series="{Binding OrdersByStatusSeries}"
                                                        XAxes="{Binding OrdersByStatusXAxis}"
                                                        YAxes="{Binding OrdersByStatusYAxis}"
                                                        LegendPosition="Hidden"
                                                        Height="240"/>
                                </StackPanel>
                            </materialDesign:Card>

                            <materialDesign:Card Grid.Row="1" Grid.Column="1" Padding="16">
                                <StackPanel>
                                    <TextBlock Text="ÐÐ°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¿Ð¾ Ð·Ð°Ð´Ð°Ñ‡Ð°Ð¼" FontSize="16" FontWeight="Medium" Margin="0,0,0,12"/>
                                    <lvc:CartesianChart Series="{Binding TasksStatusSeries}"
                                                        XAxes="{Binding TasksStatusXAxis}"
                                                        YAxes="{Binding TasksStatusYAxis}"
                                                        LegendPosition="Hidden"
                                                        Height="240"/>
                                </StackPanel>
                            </materialDesign:Card>

                            <materialDesign:Card Grid.Row="2" Grid.ColumnSpan="2" Padding="16" Margin="0,16,0,0">
                                <StackPanel>
                                    <TextBlock Text="Ð”Ð¾Ð»Ñ Ð²Ñ‹Ñ€ÑƒÑ‡ÐºÐ¸ Ð¿Ð¾ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸ÑÐ¼" FontSize="16" FontWeight="Medium" Margin="0,0,0,12"/>
                                    <lvc:PieChart Series="{Binding RevenueByCompanySeries}" LegendPosition="Right" Height="260"/>
                                </StackPanel>
                            </materialDesign:Card>
                        </Grid>

                        <materialDesign:Card Padding="16">
                            <StackPanel>
                                <TextBlock Text="Ð˜Ñ‚Ð¾Ð³Ð¸ Ð¿Ð¾ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸ÑÐ¼" FontSize="16" FontWeight="Medium" Margin="0,0,0,12"/>
                                <DataGrid ItemsSource="{Binding CompanyRevenueView}"
                                          AutoGenerateColumns="False"
                                          CanUserAddRows="False"
                                          IsReadOnly="True">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="ÐšÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ñ" Binding="{Binding CompanyName}" Width="200"/>
                                        <DataGridTextColumn Header="Ð—Ð°ÐºÐ°Ð·Ñ‹" Binding="{Binding OrdersCount}" Width="80"/>
                                        <DataGridTextColumn Header="ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ" Binding="{Binding ActiveOrdersCount}" Width="90"/>
                                        <DataGridTextColumn Header="Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾" Binding="{Binding CompletedOrdersCount}" Width="100"/>
                                        <DataGridTextColumn Header="Ð’Ñ‹Ñ€ÑƒÑ‡ÐºÐ°" Binding="{Binding TotalRevenue, StringFormat='{}{0:N0}'}" Width="120"/>
                                        <DataGridTextColumn Header="Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ñ‡ÐµÐº" Binding="{Binding AverageOrderValue, StringFormat='{}{0:N0}'}" Width="120"/>
                                        <DataGridTextColumn Header="Ð§Ð°ÑÑ‹" Binding="{Binding TotalHours, StringFormat='{}{0:N1}'}" Width="90"/>
                                        <DataGridTextColumn Header="Ð¡Ñ‚Ð°Ð²ÐºÐ°" Binding="{Binding AverageRate, StringFormat='{}{0:N1}'}" Width="90"/>
                                        <DataGridTextColumn Header="Ð ÐµÐ½Ñ‚Ð°Ð±ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ" Binding="{Binding Profitability, Converter={x:Static local:EnumDescriptionConverter.Instance}}" Width="130"/>
                                        <DataGridTextColumn Header="ÐžÑ‚Ð½Ð¾ÑˆÐµÐ½Ð¸Ñ" Binding="{Binding Relationship}" Width="120"/>
                                        <DataGridTextColumn Header="ÐŸÐ»Ð°Ñ‚ÐµÐ¶ÐµÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ð¾ÑÑ‚ÑŒ" Binding="{Binding PaymentAbility}" Width="150"/>
                                        <DataGridTextColumn Header="ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ð·Ð°ÐºÐ°Ð·" Binding="{Binding LastOrderDate, StringFormat='{}{0:dd.MM.yyyy}'}" Width="130"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </materialDesign:Card>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
    </Grid>
</Window>


